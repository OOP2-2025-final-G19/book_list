<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>読了済みリスト</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='base-style.css') }}">
</head>

<body>
    <h1>読了済みリスト</h1>

    <ul class="breadcrumb">
        <li><a href="{{ url_for('index') }}">HOME</a></li>
        <li><a href="{{ url_for('registration.read_list') }}">読了済みリスト</a></li>
    </ul>

    <a href="{{ url_for('registration.add') }}">新規書籍追加</a>

    <form method="get" style="margin-bottom: 10px;">
        <input type="text" name="q" placeholder="タイトル検索" value="{{ keyword | default('') }}">
        <button type="submit">検索</button>

        {% if keyword %}
        <a href="{{ request.path }}">クリア</a>
        {% endif %}
    </form>

    <table>
        <thead>
            <tr>
                <th>写真</th>

                <th>
                    <a href="{{ url_for(
                        'registration.read_list',
                        sort='title',
                        order='asc' if sort == 'title' and order == 'desc' else 'desc'
                    ) }}">
                        タイトル
                        {% if sort == 'title' %}
                        {{ '▲' if order == 'asc' else '▼' }}
                        {% endif %}
                    </a>
                </th>

                <th>
                    <a href="{{ url_for(
                        'registration.read_list',
                        sort='author',
                        order='asc' if sort == 'author' and order == 'desc' else 'desc'
                    ) }}">
                        著者
                        {% if sort == 'author' %}
                        {{ '▲' if order == 'asc' else '▼' }}
                        {% endif %}
                    </a>
                </th>

                <th>
                    <a href="{{ url_for(
                        'registration.read_list',
                        sort='day',
                        order='asc' if sort == 'day' and order == 'desc' else 'desc'
                    ) }}">
                        登録日
                        {% if sort == 'day' %}
                        {{ '▲' if order == 'asc' else '▼' }}
                        {% endif %}
                    </a>
                </th>

                <th>
                    <a href="{{ url_for(
                        'registration.read_list',
                        sort='review',
                        order='asc' if sort == 'review' and order == 'desc' else 'desc'
                    ) }}">
                        評価
                        {% if sort == 'review' %}
                        {{ '▲' if order == 'asc' else '▼' }}
                        {% endif %}
                    </a>
                </th>

                <th>備考</th>
            </tr>
        </thead>

        <tbody>
            {% for registration in items %}
            <tr>
                <td>
                    {% if registration.image_path %}
                    <img src="{{ url_for('static', filename=registration.image_path.replace('static/', '')) }}"
                        alt="書籍写真" width="100">
                    {% else %}
                    なし
                    {% endif %}
                </td>

                <td ondblclick="editCell(this, {{ registration.id }}, 'title')">
                    {{ registration.title }}
                </td>

                <td ondblclick="editCell(this, {{ registration.id }}, 'author')">
                    {{ registration.author }}
                </td>

                <td>
                    {{ registration.day.strftime('%Y/%m/%d') }}
                </td>

                <td ondblclick="editCell(this, {{ registration.id }}, 'review')">
                    {{ registration.review }}
                </td>

                <td ondblclick="editCell(this, {{ registration.id }}, 'thoughts')">
                    {{ registration.thoughts }}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <script src="{{ url_for('static', filename='js/edit_cell.js') }}"></script>
</body>

</html>